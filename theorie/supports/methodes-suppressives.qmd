---
title: Les m√©thodes suppressives
subtitle: |
  **[Pour donn√©es tabul√©es ou individuelles]{.orange}**
order: 3
href: theorie/supports/methodes-suppressives.html
image: ../../images/theorie.png
# date: 
slide-number: true
header: |
  [Retour √† l'accueil](https://github.com/InseeFrLab/formation_protection_donnees)
footer: |
  Les m√©thodes de protection statistique des donn√©es confidentielles
# uncomment for French presentations:
lang: fr-FR
# for blind readers:
slide-tone: false
# for @olevitt:
# chalkboard: # press the B key to toggle chalkboard
#   theme: whiteboard
# uncomment to use the multiplex mode:
#multiplex: true
format:
  onyxia-revealjs
  # pick the light mode (onyxia-revealjs) or the dark mode (onyxia-dark-revealjs)
  #onyxia-dark-revealjs:
controls: true
css: custom.css
# from: markdown+emoji
# listing:
#   id: sample-listings
#   contents: teaching
#   sort: "date desc"
#   type: table
bibliography: ../../references-SDC.bib
# csl: ../style.csl  # D√©commentez besoin d'un style de biblio sp√©cifique
---

## Les m√©thodes √† disposition

::: frame

Deux types de m√©thodes en fonction du moment o√π elles sont appliqu√©es :

- Les **m√©thodes pr√©-tabulation** sont appliqu√©es sur les donn√©es individuelles, *i.e.* **avant** toute tabulation
- Les **m√©thodes post-tabulation** sont appliqu√©es sur les donn√©es agr√©g√©es, *i.e.* **apr√®s** tabulation

:::

## Les m√©thodes √† disposition

| Type de m√©thode     | Type de donn√©es                     | **M√©thodes**                          |
|---------------------|-------------------------------------|----------------------------------------|
| Pr√©-tabulation      | Micro-donn√©es\index{Microdata}      | Recodage des variables  <br> Suppression locale |
| Post-tabulation     | Donn√©es tabul√©es                    | Suppression de cellules <br> Regroupement de cat√©gories |


# Les m√©thodes pr√©-tabulation

## Le recodage des variables

| id | √¢ge | Genre | Profession   |
|----|-----|-------|--------------|
| 1  | 23  | H     | statistiques |
| 2  | 24  | H     | statistiques |
| 3  | 50  | F     | statistiques |
| 4  | 53  | H     | statistiques |
| 5  | 51  | F     | statistiques |

## Le recodage des variables

| id | √¢ge   | Genre | Profession   |
|----|-------|-------|--------------|
| 1  | 20-30 | H     | statistiques |
| 2  | 20-30 | H     | statistiques |
| 3  | 50-60 | F     | statistiques |
| 4  | 50-60 | H     | statistiques |
| 5  | 50-60 | F     | statistiques |

## La suppression locale

S'applique aux variables cat√©gorielles.

. . .

Suppression d'au moins une cat√©gorie pr√©sente dans une combinaison √† risque, i.e. on la remplace par une **valeur manquante**.

. . . 

| id | Lieu de r√©sidence | Genre | Profession   |
|----|-------------------|-------|--------------|
| 1  | poitiers          | H     | statistiques |
| 2  | poitiers          | H     | statistiques |
| 3  | barfleur          | H     | p√™che        |
| 4  | barfleur          | H     | p√™che        |
| 5  | barfleur          | F     | maire        |

## La suppression locale

| id | Lieu de r√©sidence | Genre | Profession   |
|----|-------------------|-------|--------------|
| 1  | poitiers          | H     | statistiques |
| 2  | poitiers          | H     | statistiques |
| 3  | barfleur          | H     | p√™che        |
| 4  | barfleur          | H     | p√™che        |
| 5  | barfleur          | F     | *NA*         |

# Les m√©thodes post-tabulation

Regroupement des cat√©gories et suppression de cellules.

## Tableaux d'effectifs

|                   | Nord | Ouest | Est | Sud | Total |
|:------------------|-----:|------:|----:|----:|------:|
| **Polluante**     |    6 |    14 |   1 |   7 |    28 |
| **Non polluante** |    3 |     2 |   1 |  13 |    19 |
| **Total**         |    9 |    16 |   2 |  20 |    47 |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 1 ‚Äì Nombre d'entreprises polluantes par r√©gion
</div>

. . .

Y a-t-il des cellules √† risque ?

## Tableaux d'effectifs

**R√®gle de fr√©quence** : une cellule d'un tableau ne doit pas √™tre construite √† partir de strictement moins de n unit√©s (n > 0).  

<br>

Pour les donn√©es entreprises √† l'Insee, n = 3.

## Tableaux d'effectifs

|                   | Nord | Ouest | Est | Sud | Total |
|:------------------|-----:|------:|----:|----:|------:|
| **Polluante**     |    6 |    14 | <span style="color: red;">1</span> |   7 |    28 |
| **Non polluante** |    3 | <span style="color: red;">2</span> | <span style="color: red;">1</span> |  13 |    19 |
| **Total**         |    9 |    16 | <span style="color: red;">2</span> |  20 |    47 |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 1 ‚Äì Nombre d'entreprises polluantes par r√©gion
</div>

## Tableaux de volume

|                   | Harpes | Piano | Orgues  |  Total |
|:------------------|------:|------:|------:|------:|------:|
| **Nord**          |     58 |     71 |     92 |    221 |
| **Centre**        |     11 |    124 |    157 |    292 |
| **Sud**           |     36 |     24 |     60 |    120 |
| **Total**         |    105 |    219 |    309 |    633 |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 2 ‚Äì R√©partition des ventes d'instruments par r√©gion et par type, en millions d'euros
</div>

. . .

Y a-t-il des cellules √† risque ?

## Tableaux de volume

| R√©gion     | Harpes           | Piano            | Orgues           | Total            |
|:-----------|-----------------:|-----------------:|-----------------:|-----------------:|
| **Nord**   | 58 <span style="color:blue;" title="Nombre d'entreprises"> (5)</span>   | 71 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span>  | 92 <span style="color:blue;" title="Nombre d'entreprises"> (5)</span>   | 221 <span style="color:blue;" title="Nombre d'entreprises"> (27)</span> |
| **Centre** | 11 <span style="color:blue;" title="Nombre d'entreprises"> (4)</span>   | 124 <span style="color:blue;" title="Nombre d'entreprises"> (11)</span> | 157 <span style="color:blue;" title="Nombre d'entreprises"> (2)</span>  | 292 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span> |
| **Sud**    | 36 <span style="color:blue;" title="Nombre d'entreprises"> (3)</span>   | 24 <span style="color:blue;" title="Nombre d'entreprises"> (6)</span>   | 60 <span style="color:blue;" title="Nombre d'entreprises"> (1)</span>   | 120 <span style="color:blue;" title="Nombre d'entreprises"> (10)</span> |
| **Total**  | 105 <span style="color:blue;" title="Nombre d'entreprises"> (12)</span> | 219 <span style="color:blue;" title="Nombre d'entreprises"> (34)</span> | 309 <span style="color:blue;" title="Nombre d'entreprises"> (8)</span>  | 633 <span style="color:blue;" title="Nombre d'entreprises"> (54)</span> |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 2 ‚Äì R√©partition des ventes d'instruments par r√©gion et par type, en millions d'euros
</div>

<div style="font-size: 0.9em; margin-top: 0.5em;">
  <em>Note :</em> les valeurs entre parenth√®ses indiquent le <span style="color:blue;">nombre de contributeurs</span>.
</div>

## Tableaux de volume

Secret primaire de fr√©quence.

| R√©gion     | Harpes           | Piano            | Orgues           | Total            |
|:-----------|-----------------:|-----------------:|-----------------:|-----------------:|
| **Nord**   | 58 <span style="color:blue;" title="Nombre d'entreprises"> (5)</span>   | 71 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span>  | 92 <span style="color:blue;" title="Nombre d'entreprises"> (5)</span>   | 221 <span style="color:blue;" title="Nombre d'entreprises"> (27)</span> |
| **Centre** | 11 <span style="color:blue;" title="Nombre d'entreprises"> (4)</span>   | 124 <span style="color:blue;" title="Nombre d'entreprises"> (11)</span> | 157 <span style="color:red;" title="n<3"> (2)</span>  | 292 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span> |
| **Sud**    | 36 <span style="color:blue;" title="Nombre d'entreprises"> (3)</span>   | 24 <span style="color:blue;" title="Nombre d'entreprises"> (6)</span>   | 60 <span style="color:red;" title="n<3"> (1)</span>   | 120 <span style="color:blue;" title="Nombre d'entreprises"> (10)</span> |
| **Total**  | 105 <span style="color:blue;" title="Nombre d'entreprises"> (12)</span> | 219 <span style="color:blue;" title="Nombre d'entreprises"> (34)</span> | 309 <span style="color:blue;" title="Nombre d'entreprises"> (8)</span>  | 633 <span style="color:blue;" title="Nombre d'entreprises"> (54)</span> |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 2 ‚Äì R√©partition des ventes d'instruments par r√©gion et par type, en millions d'euros
</div>

<div style="font-size: 0.9em; margin-top: 0.5em;">
  <em>Note :</em> les valeurs entre parenth√®ses indiquent le <span style="color:blue;">nombre de contributeurs</span>.
</div>

## Tableaux de volume

**R√®gle de dominance (n,k)** : une cellule est sensible si les n plus grands contributeurs de cette cellule repr√©sentent plus de k% du total de celle-ci.

<br>

- Pour les donn√©es entreprises √† l'Insee, n = 1 et k = 85. Donc, 1 unit√© contributrice √† une cellule ne peut contribuer √† plus de 85% de la valeur de celle-ci.
- Pour chaque cellule du tableau, besoin de d√©terminer le plus gros contributeur.

## Tableaux de volume

Secret primaire de dominance.

| R√©gion     | Harpes           | Piano            | Orgues           | Total            |
|:-----------|-----------------:|-----------------:|-----------------:|-----------------:|
| **Nord**   | 58 <span style="color:blue;" title="Nombre d'entreprises"> (5)</span>   | 71 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span>  | <span style="color:orange;" title="92 = 86 + 3 + 1 + 1 + 1">92</span> <span style="color:orange;" title="k = 93% > 85%"> (5)</span>   | 221 <span style="color:blue;" title="Nombre d'entreprises"> (27)</span> |
| **Centre** | 11 <span style="color:blue;" title="Nombre d'entreprises"> (4)</span>   | 124 <span style="color:blue;" title="Nombre d'entreprises"> (11)</span> | 157 <span style="color:red;" title="SP fr√©quence"> (2)</span>  | 292 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span> |
| **Sud**    | 36 <span style="color:blue;" title="Nombre d'entreprises"> (3)</span>   | 24 <span style="color:blue;" title="Nombre d'entreprises"> (6)</span>   | 60 <span style="color:red;" title="SP fr√©quence"> (1)</span>   | 120 <span style="color:blue;" title="Nombre d'entreprises"> (10)</span> |
| **Total**  | 105 <span style="color:blue;" title="Nombre d'entreprises"> (12)</span> | 219 <span style="color:blue;" title="Nombre d'entreprises"> (34)</span> | 309 <span style="color:blue;" title="Nombre d'entreprises"> (8)</span>  | 633 <span style="color:blue;" title="Nombre d'entreprises"> (54)</span> |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 2 ‚Äì R√©partition des ventes d'instruments par r√©gion et par type, en millions d'euros
</div>

<div style="font-size: 0.9em; margin-top: 0.5em;">
  <em>Note :</em> les valeurs entre parenth√®ses indiquent le <span style="color:blue;">nombre de contributeurs</span>.
</div>

## Tableaux de volume

**R√®gle du p%** : une cellule est sensible si l'un des contributeurs a une cellule peut estimer la valeur d'un autre contributeur √† p% de sa v√©ritable valeur.

- En pratique, le 2eme contributeur de la valeur de la cellule ne doit pas pouvoir estimer en utilisant sa propre valeur, celle du premier contributeur avec une pr√©cision sup√©rieure √† p%.
- Il est d'usage de choisir p = 10.
- Pas utilis√©e √† l'Insee mais recommand√©e par les experts europ√©ens.

## Tableaux de volume

Secret primaire d√ª √† la r√®gle du p%.

| R√©gion     | Harpes           | Piano            | Orgues           | Total            |
|:-----------|-----------------:|-----------------:|-----------------:|-----------------:|
| **Nord**   | 58 <span style="color:blue;" title="Nombre d'entreprises"> (5)</span>   | 71 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span>  | <span style="color:orange;" title="92 = 86 + 3 + 1 + 1 + 1">92</span> <span style="color:orange;" title="k = 93% > 85%"> (5)</span>   | 221 <span style="color:blue;" title="Nombre d'entreprises"> (27)</span> |
| **Centre** | 11 <span style="color:blue;" title="Nombre d'entreprises"> (4)</span>   | 124 <span style="color:blue;" title="Nombre d'entreprises"> (11)</span> | 157 <span style="color:red;" title="SP fr√©quence"> (2)</span>  | 292 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span> |
| **Sud**    | <span style="color:purple;" title="36 = 19 + 16 + 1">36</span> <span style="color:purple;" title="p = 5,3% < 10%"> (3)</span>   | 24 <span style="color:blue;" title="Nombre d'entreprises"> (6)</span>   | 60 <span style="color:red;" title="SP fr√©quence"> (1)</span>   | 120 <span style="color:blue;" title="Nombre d'entreprises"> (10)</span> |
| **Total**  | 105 <span style="color:blue;" title="Nombre d'entreprises"> (12)</span> | 219 <span style="color:blue;" title="Nombre d'entreprises"> (34)</span> | 309 <span style="color:blue;" title="Nombre d'entreprises"> (8)</span>  | 633 <span style="color:blue;" title="Nombre d'entreprises"> (54)</span> |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 2 ‚Äì R√©partition des ventes d'instruments par r√©gion et par type, en millions d'euros
</div>

<div style="font-size: 0.9em; margin-top: 0.5em;">
  <em>Note :</em> les valeurs entre parenth√®ses indiquent le <span style="color:blue;">nombre de contributeurs</span>.
</div>

## Le secret primaire

Les cellules cat√©goris√©es √† risque pour la r√®gle de fr√©quence, la r√®gle de dominance et la r√®gle du p% constituent le secret primaire. On ne peut pas diffuser ces cellules.

<br>

Comment faire ?

## Le regroupement de cat√©gories
Red√©finir le contenu des variables de croisement en **diminuant le nombre de** leur **modalit√©s**.

<br>

Permet de r√©duire fortement, voir d'enlever compl√®tement le secret primaire. 

<br>

Envisager cette option avant les autres m√©thodes.

## Le recodage : un exemple

|                   | <25 | 25-30 | 30-50 | > 50 | Total |
|:------------------|----:|------:|------:|-----:|------:|
| **Polluante**     |   <span style="color: red;">2</span> |     5 |     7 |    6 |    20 |
| **Non polluante** |   8 |    15 |    17 |   20 |    60 |
| **Total**         |  10 |    20 |    24 |   26 |    80 |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 3 ‚Äì Nombre d'entreprises polluantes selon l'√¢ge du dirigeant
</div>

. . .

D√©finir de nouvelles modalit√©s pour augmenter le nombre de r√©pondants par cellule.

## Le recodage : un exemple

|                   | <28 | 28-35 | 35-55 | > 55 | Total |
|:------------------|----:|------:|------:|-----:|------:|
| **Polluante**     |   3 |     6 |     6 |    5 |    20 |
| **Non polluante** |   9 |    17 |    19 |   15 |    60 |
| **Total**         |  12 |    23 |    25 |   20 |    80 |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 3bis ‚Äì Nombre d'entreprises polluantes selon l'√¢ge du dirigeant
</div>

## Le recodage : √† vous de jouer !

On cherche √† publier le tableau suivant :

- Population d'une r√©gion par leur zone d'emploi de r√©sidence, leur zone d'emploi de travail, leur profession et leur √¢ge.
- Beaucoup de secret primaire dans ce tableau puisque la plupart des gens r√©sident et travaillent dans la m√™me zone d'emploi.
- Comment recoder ce tableau ?

. . .

Un premier recodage consiste √† regrouper toutes les zones d'emploi de travail hors r√©gion dans une seule cat√©gorie.

## Le recodage

| üëç | üëé |
|:--:|:--:|
| R√©duit le SP. | Ne supprime pas toujours totalement le SP. |
| Tr√®s simple √† mettre en place. | Impossible dans certains cas (structure impos√©e, suivi dans le temps). |

. . .

Comment prot√©ger le secret primaire restant ?

# La suppression de cellules

## Le secret primaire

Premi√®re √©tape : supprimer les cellules ne respectant pas les r√®gles du secret primaire.

|                   | Nord | Ouest | Est | Sud | Total |
|:------------------|-----:|------:|----:|----:|------:|
| **Polluante**     |    6 |    14 | <span style="color: red;">X</span> |   7 |    28 |
| **Non polluante** |    3 | <span style="color: red;">X</span> | 3 |  13 |    21 |
| **Total**         |    9 |    16 | 4 |  20 |    49 |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 1 ‚Äì Nombre d'entreprises polluantes par r√©gion
</div>
. . .

Ce n'est pas suffisant, les cellules sont li√©es entre elles par des √©quations (marges).

## Le secret secondaire

Deuxi√®me √©tape : supprimer des cellules pour prot√©ger le secret primaire.

|                   | Nord | Ouest |  Est | Sud | Total |
|:------------------|-----:|------:|-----:|----:|------:|
| **Polluante**     |    6 | <span style="color: red;">X</span> | <span style="color: red;">X</span> |   7 |    28 |
| **Non polluante** |    3 | <span style="color: red;">X</span> | <span style="color: red;">X</span> |  13 |    21 |
| **Total**         |    9 |    16                              | 4                                  |  20 |    49 |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 1 ‚Äì Nombre d'entreprises polluantes par r√©gion
</div>

## Le secret secondaire

Plusieurs structures de suppressions (masques de secret) sont possibles.

|                   | Nord | Ouest |  Est | Sud | Total |
|:------------------|-----:|------:|-----:|----:|------:|
| **Polluante**     | <span style="color: red;">X</span> |     14                             | <span style="color: red;">X</span> |   7 |    28 |
| **Non polluante** | <span style="color: red;">X</span> | <span style="color: red;">X</span> |   3                                |  13 |    21 |
| **Total**         |    9 | <span style="color: red;">X</span> | <span style="color: red;">X</span> |  20 |    49 |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 1 ‚Äì Nombre d'entreprises polluantes par r√©gion
</div>

## Les intervalles de protection

Cacher des cellules revient √† diffuser des intervalles.

|                   | Nord | Ouest    |  Est    | Sud | Total |
|:------------------|-----:|---------:|--------:|----:|------:|
| **Polluante**     |    6 | <span style="color: red;">[11 ; 15]</span> | <span style="color: red;">[0 ; 4]</span> |   7 |    28 |
| **Non polluante** |    3 | <span style="color: red;">[1 ; 5]</span> | <span style="color: red;">[0 ; 4]</span> |  13 |    21 |
| **Total**         |    9 |    16                              | 4                                  |  20 |    49 |


**L'intervalle des possibles** : l'ensemble des valeurs possibles prises par la cellule supprim√©e apr√®s avoir pos√© le masque de secret.

## Les intervalles de protection

**L'intervalle de protection** : soit $V_C$ la valeur d'une cellule C sensible √† la r√®gle de fr√©quence et $m\%$ la marge protection choisie.

<br>

$[(1 - m\%). V_C ; (1 + m\%). V_C]$

<br>

En pratique on choisit souvent une marge de 10%, $[90\%.V_C ; 110\%.V_C]$

## Les intervalles de protection

| R√©gion     | Harpes           | Piano            | Orgues           | Total            |
|:-----------|-----------------:|-----------------:|-----------------:|-----------------:|
| **Nord**   | 58 <span style="color:blue;" title="Nombre d'entreprises"> (5)</span>   | 71 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span>  | 92 <span style="color:blue;" title="Nombre d'entreprises"> (5)</span>   | 221 <span style="color:blue;" title="Nombre d'entreprises"> (27)</span> |
| **Centre** | 11 <span style="color:blue;" title="Nombre d'entreprises"> (4)</span>   | 124 <span style="color:blue;" title="Nombre d'entreprises"> (11)</span> | <span style="color:red;" title="[141.3 ; 172.7]">157</span>  <span style="color:red;" title="n < 3"> (2)</span>  | 292 <span style="color:blue;" title="Nombre d'entreprises"> (17)</span> |
| **Sud**    | 36 <span style="color:blue;" title="Nombre d'entreprises"> (3)</span>   | 24 <span style="color:blue;" title="Nombre d'entreprises"> (6)</span>   | <span style="color:red;" title="[54 ; 66]">60</span> <span style="color:red;" title="n < 3"> (1)</span>   | 120 <span style="color:blue;" title="Nombre d'entreprises"> (10)</span> |
| **Total**  | 105 <span style="color:blue;" title="Nombre d'entreprises"> (12)</span> | 219 <span style="color:blue;" title="Nombre d'entreprises"> (34)</span> | 309 <span style="color:blue;" title="Nombre d'entreprises"> (8)</span>  | 633 <span style="color:blue;" title="Nombre d'entreprises"> (54)</span> |

<div style="text-align: center; font-weight: bold; margin-bottom: 0.5em;">
  Tableau 2 ‚Äì R√©partition des ventes d'instruments par r√©gion et par type, en millions d'euros
</div>

<div style="font-size: 0.9em; margin-top: 0.5em;">
  <em>Note :</em> glisser la souris sur les valeurs en secret primaire de fr√©quence pour voir les intervalles de protection.
</div>

## Les intervalles de protection

**R√®gle des intervalles** : l'intervalle de protection de chaque cellule sensible doit √™tre inclus dans son intervalle des possibles.

<br>

Cette r√®gle permet de se pr√©munir d'une divulgation par inf√©rence.

## Les intervalles de protection

Exemple avec une marge de protection de 10%.

| R√©gion     | Harpe | Piano  | Orgue   | Autre   | Total     |
|:-----------|------:|-------:|--------:|--------:|----------:|
| **Nord**   | 58   | 71   | 92    | 800   | **1021**  |
| **Centre** | 11    | 124  | <span style="color:red;" title="[141 ; 173]">157 (2)</span>   | 934    | **1226** |
| **Sud**    | 36    | 24  | <span style="color:red;" title="[54 ; 66]">60 (1)</span>   | 651   | **771** |
| **Total**  | **105** | **219** | **309**  | **2385** | **3018** |

<div style="font-size: 0.9em; margin-top: 0.5em;">
  <em>Note :</em> glisser la souris sur les valeurs en secret primaire de fr√©quence pour voir les intervalles de protection.
</div>

## Les intervalles de protection

Exemple avec une marge de protection de 10%.

| R√©gion     | Harpe | Piano  | Orgue   | Autre   | Total     |
|:-----------|------:|-------:|--------:|--------:|----------:|
| **Nord**   | X   | 71   | X    | 800   | **1021**  |
| **Centre** | X    | 124  | <span style="color:red;" title="[141 ; 173]">X</span>   | 934    | **1226** |
| **Sud**    | X    | 24  | <span style="color:red;" title="[54 ; 66]">X</span>   | 651   | **771** |
| **Total**  | **105** | **219** | **309**  | **2385** | **3018** |

<div style="font-size: 0.9em; margin-top: 0.5em;">
  <em>Note :</em> glisser la souris sur les valeurs en secret primaire de fr√©quence pour voir les intervalles de protection.
</div>

## Les intervalles de protection

Exemple avec une marge de protection de 10%.

| R√©gion     | Harpe | Piano  | Orgue   | Autre   | Total     |
|:-----------|------:|-------:|--------:|--------:|----------:|
| **Nord**   | [0;105]   | 71   | [45;150]    | 800   | **1021**  |
| **Centre** | [0;105]    | 124  | <span style="color:red;" title="[141 ; 173]">[63;168]</span>   | 934    | **1226** |
| **Sud**    | [0;96]    | 24  | <span style="color:red;" title="[54 ; 66]">[0;96]</span>   | 651   | **771** |
| **Total**  | **105** | **219** | **309**  | **2385** | **3018** |

<div style="font-size: 0.9em; margin-top: 0.5em;">
  <em>Note :</em> glisser la souris sur les valeurs en secret primaire de fr√©quence pour voir les intervalles de protection.
</div>

## Les intervalles de protection

La borne sup√©rieure de l'intervalle des possibles (168) est inf√©rieure √† la borne sup√©rieure de l'intervalle de protection (173).

![](./img/ex_intervalle_protection_formation.png)


## Les intervalles de protection

![](./img/ex_intervalle_protection_formation.png)

On peut inf√©rer la valeur de la cellule √† <span title="157 + (7/100)*157 = 168">7%</span> et non 10%.

La cellule n'est pas suffisamment prot√©g√©e.

## Les intervalles de protection

On utilise un autre masque de secret ...

| R√©gion     | Harpe | Piano  | Orgue   | Autre   | Total     |
|:-----------|------:|-------:|--------:|--------:|----------:|
| **Nord**   | 58   | X   | X    | 800   | **1021**  |
| **Centre** | 11    | X  | <span style="color:red;" title="[141 ; 173]">X</span>   | 934    | **1226** |
| **Sud**    | 36    | X  | <span style="color:red;" title="[54 ; 66]">X</span>   | 651   | **771** |
| **Total**  | **105** | **219** | **309**  | **2385** | **3018** |


## Les intervalles de protection

... avec d'autres intervalles des possibles.

| R√©gion     | Harpe | Piano  | Orgue   | Autre   | Total     |
|:-----------|------:|-------:|--------:|--------:|----------:|
| **Nord**   | 58   | [0;163]   | [0;163]    | 800   | **1021**  |
| **Centre** | 11    | [0;219]  | <span style="color:red;" title="[141 ; 173]">[62;281]</span>   | 934    | **1226** |
| **Sud**    | 36   | [0;84]  | <span style="color:red;" title="[54 ; 66]">[0;84]</span>   | 651   | **771** |
| **Total**  | **105** | **219** | **309**  | **2385** | **3018** 

## Les intervalles de protection

![](./img/ex_intervalle_protection_formation2.png)

Avec cet autre masque de secret la cellule est suffisamment prot√©g√©e.

## Minimiser la perte d'information

Pour minimiser la perte d'information, il faut d√©finir pour chaque cellule un **co√ªt** associ√© √† sa suppression.

<br>

Plusieurs possibilit√©s :

- Le nombre de cellules supprim√©es
- Le nombre de contributeurs concern√©s par les cases supprim√©es
- La valeur de la cellule (d√©faut Tau-Argus)
- Un autre variable / co√ªt ajust√©

# Les outils

## $\tau$-Argus

<div style="display: flex; align-items: center; justify-content: space-between;">
  <ul>
    <li>Permet de calculer le secret primaire et secondaire ou faire des arrondis contr√¥l√©s</li>
    <li>D√©veloppement maintenance et support : group√© d'expert europ√©ens coordonn√© par CBS</li>
    <li>Logiciel de r√©f√©rence en Europe pour g√©rer la confidentialit√© des tableaux</li>
    <li>Logiciel libre et open source</li>
    <li>Derni√®re version stable 4.2.4 (26 avril 2023)</li>
  </ul>
  <img src="./img/tau_argus_logo.png" alt="Tau-Argus Logo" style="height: 200px; margin-left: 20px; object-fit: contain;">
</div>


## $\tau$-Argus

| üëç | üëé |
|:--:|:--:|
| Outil qui fait r√©f√©rence. | Interface fouillis. |
| Performant sur la partie pose de secret gr√¢ce √† une optimisation globale. | Bugs et erreurs pas faciles √† comprendre et corriger. |
|Outil maintenu r√©guli√®rement. | Reproductibilit√© des op√©rations limit√©es. |

## rtauargus

Un package R pour b√©n√©ficier des avantages de $\tau$-Argus tout en limitant les inconv√©nients.

<div style="display: flex; align-items: flex-start; justify-content: space-between;">
  <ul>
    <li>D√©velopp√© √† l'Insee</li>
    <li>[Code open-source](https://github.com/InseeFrLab/rtauargus)
</li>
    <li>Version la plus r√©cente 02/25 : v-1.2.999-dev</li>
    <li>[Une documentation en ligne](https://inseefrlab.github.io/rtauargus/)</li>
    <li>Utiliser les fonctions tab_XXX()</li>
  </ul>
  <img src="./img/rtauargus_logo_sans_fond.png" alt="rtauargus Logo" style="height: 200px; margin-left: 20px;">
</div>

## rtauargus

Fonctionnement du package :

- cr√©e l'ensemble des fichiers dans les formats attendus par $\tau$-Argus
- Lance $\tau$-Argus
- R√©cup√®re les r√©sultats dans R

## rtauargus

1) Poser le secret primaire "manuellement"
2) Poser le secret secondaire avec :
  - `tab_rtauargus()` : pour prot√©ger un seul tableau
  - `tab_multi_manager()` : pour prot√©ger plusieurs tableaux
  
## rtauargus

Besoin de retours utilisateurs : cr√©er une [issue sur github](https://github.com/InseeFrLab/rtauargus/issues).

Ou nous contacter par [mail](mailto:dg75_dmcsi-confidentialite@insee.fr).


# Les hi√©rarchies

## Tableaux hi√©rarchis√©s

![](./img/pres_hrc-clear.png)

## Tableaux hi√©rarchis√©s

![](./img/pres_hrc_2-clear.png)

. . . 

Si on ne renseigne pas la hi√©rarchie, on peut retrouver la valeur cach√©e.

## Tableaux hi√©rarchis√©s

![](./img/pres_hrc_3-clear.png)

. . .

Lorsque la hi√©rarchie est renseign√©e, on prot√®ge bien les donn√©es.

## Le format Argus des hi√©rarchies

Dans $\tau$-Argus les hi√©rarchies sont pr√©sent√©es dans un format particulier : fichier texte **.hrc**.

- Doit d√©crire parfaitement l'embo√Ætement
- Le nombre de @ d√©signe le niveau d'embo√Ætement de chaque cat√©gorie
- Ne fait pas appara√Ætre le total
- La fonction `write_hrc2()` permet de cr√©er un fichier **.hrc** √† partir d'une table de passage

# Prot√©ger des tableaux li√©s


## Prot√©ger des tableaux li√©s avec rtauargus

Utiliser la fonction `tab_multi_manager()` :  

1) L'utilisateur d√©crit les tableaux
2) Fusion automatique de tous les tableaux entre eux
3) Algorithme g√®re la protection it√©rative des tableaux

N.B. La pose du secret √† chaque it√©ration est effectu√©e avec $\tau$-Argus.

. . .

La fonction `tab_multi_manager()` fournit un journal sous forme de reporting (√©tapes pose secret).

# Analyser une demande

## L'analyse d'une demande
Il faut rep√©rer les liens entre les tableaux pour poser un secret qui les prot√®ge vraiment.

Les tableaux diffus√©s ne sont pas les m√™mes que les tableaux √† prot√©ger.

## Etapes de l'analyse
1) R√©unir les informations n√©cessaires √† la description des tableaux

- champ
- variables de croisements
- variable de r√©ponses (i.e. indicateur)
- tableaux de fr√©quence ou de volumes ?
- description des embo√Ætements pour les hi√©rarchies
- √©quations ou corr√©lations entre les variables de r√©ponses

## Etapes de l'analyse
2) La demande peut-elle √™tre d√©coup√©e en sous-demandes ind√©pendantes ?

- champs diff√©rents et non compl√©mentaires $\perp\!\!\!\perp$
- variable de r√©ponses diff√©rentes (et non li√©es par une √©quation / corr√©lation) $\perp\!\!\!\perp$
- variables de croisement toutes diff√©rentes $\perp\!\!\!\perp$

Dans les cas d'ind√©pendance il faut *g√©rer s√©par√©ment les diff√©rentes sous-demandes*.

## Etapes de l'analyse
3) Lister les tableaux n√©cessaires pour la pose du secret

- Certaines hi√©rarchies peuvent conduire √† unifier des tableaux
- Si tableaux additifs, construire un unique tableau en cr√©ant une variable suppl√©mentaire
- Si hi√©rarchie non-embo√Æt√©e, extraire les niveaux concern√©s pour construire un tableau suppl√©mentaire

## Etapes de l'analyse
4) Pr√©parer les hi√©rarchies

- D√©tecter les variables hi√©rarchiques
- Construire les fichiers .hrc n√©cessaires (manuellement ou avec `write_hrc2()`)

# Liens sp√©cifiques
## Traiter un lien additif entre des variables r√©ponses

<div style="display: flex; gap: 20px;">

<div style="flex: 1;">

|       | reg1   | reg2   | **T**  |
|-------|--------|--------|--------|
| **tr1** | 5      | 10     | **15** |
| **tr2** | 12     | 18     | **30** |
| **tr3** | 5      | 5      | **10** |
|  **T**  | **22** | **33** | **55** |
<p style="text-align: center;"><strong>CA couteaux</strong></p>
</div>

<div style="flex: 1;">

|       | reg1   | reg2   | **T**  |
|-------|--------|--------|--------|
| **tr1** | 3      | 8      | **11** |
| **tr2** | 6      | 20     | **26** |
| **tr3** | 2      | 6      | **8**  |
| **T** | **11** | **34** | **45** |
<p style="text-align: center;"><strong>CA fourchettes</strong></p>
</div>

<div style="flex: 1;">

|       | reg1   | reg2   | **T**  |
|-------|--------|--------|--------|
| **tr1** | 8      | 18     | **26** |
| **tr2** | 18     | 38     | **56** |
| **tr3** | 7      | 11     | **18** |
| **T** | **33** | **67** | **100**|
<p style="text-align: center;"><strong>CA couverts</strong></p>
</div>

</div>

<br>

Lien entre les CA : "couverts = couteaux + fourchettes".

## Traiter un lien additif entre des variables r√©ponses

Nouvelle variable de croisement : "type_couverts".

| **R√©gion** |   **Tr**   |   **type_couverts**  |  **chiffre_affaires**  |
| ---------- | ---------- | -------------------- | ---------------------- |
| reg1       |     tr1    | couteaux             | 5                      |
| reg1       |     tr1    | fourchettes          | 3                      |
| reg1       |     tr1    | couverts             | 8                      |
| ...        |     ...    | ...                  | ...                    |
| **Total**  | **Total**  | **couverts**         | **100**                |



## Traiter une hi√©rarchie non-embo√Æt√©e

![](./img/hrc_non_emb-clear.png){fig-align="center"}



Ici, l'agr√©gat `50+` ne peut pas √™tre bien embo√Æt√© dans la hi√©rarchie.

## Traiter une hi√©rarchie non-embo√Æt√©e

![](./img/hrc_non_emb_grp-clear.png){fig-align="center"}

Cr√©er un second tableau contenant uniquement la ventilation de 50+.

## Traiter une hi√©rarchie non-embo√Æt√©e

::: columns
::: column
`princ.hrc`

<25  
25-29  
30-69  
\@30-49  
\@50-69  
70+  
:::

::: column
`alt.hrc`

50-69  
70+  
:::
:::

# Faire la fiche pratique
[Prot√©ger des tableaux avec une m√©thode suppressive](../../pratique/fiches/proteger-tableaux-suppressif.qmd)


